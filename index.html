<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>Сибирь Барбершоп</title>
  <link rel="stylesheet" href="css/style.css">
  <!-- Telegram Web App JS -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <!-- ... ваш хэдер, навигация, контент ... -->
  <nav class="icon-nav">
    <!-- ... другие кнопки ... -->
    <button id="share-btn" class="icon-btn" data-action="share">
      <img src="images/icon-share.png" alt="Поделиться">
      <span>Поделиться</span>
    </button>
    <!-- ... -->
  </nav>

  <!-- ... остальной контент ... -->

  <footer class="footer">
    <small>30.0.0-1508</small>
  </footer>

  <script>
    // 1) Инициализируем WebApp
    const tg = window.Telegram.WebApp;
    tg.ready();
    console.log("✅ WebApp ready, shareData:", typeof tg.shareData);

    // 2) Остальные кнопки (адрес, записи, профиль...)
    document.querySelectorAll('.icon-btn').forEach(btn => {
      const action = btn.dataset.action;
      btn.onclick = () => {
        switch (action) {
          case 'address':
            tg.openLink('https://yandex.ru/maps/org/sibir/237591966386/');
            break;
          case 'appointments':
            window.location.href = 'record.html';
            break;
          case 'profile':
            window.location.href = 'profile.html';
            break;
          case 'share':
            // Ниже — код «Поделиться»
            const shareUrl  = 'https://t.me/SIBIR_BARBERSHOP_bot';
            const shareText = 'Присоединяйтесь к боту «Сибирь Барбершоп»!';

            // A) Telegram WebApp API
            if (typeof tg.shareData === 'function') {
              tg.shareData({ text: shareText, url: shareUrl });
              console.log('▶ tg.shareData called');
              return;
            }
            // B) Web Share API
            if (navigator.share) {
              navigator.share({
                title: shareText,
                text:  shareText,
                url:   shareUrl
              })
              .then(() => console.log('▶ navigator.share OK'))
              .catch(e => console.warn('▶ navigator.share error', e));
              return;
            }
            // C) prompt‑fallback
            window.prompt('Скопируйте ссылку и поделитесь:', shareUrl);
            break;
        }
      };
    });
  </script>
</body>
</html>
